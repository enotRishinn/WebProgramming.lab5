extends layout

block content
  .mainBody
    .topPanel
      .leftPanel
        form.addForm(action='/add', method='post')
          p Имя файла
          input.addFile(type='text', name='addFile')
          br
          br
          button.addButton(type='submit') Создать файл
        br
        br
        if (fileName !== null)
         .saveFile
           form#update(action='/update', method='post')
             input(type='hidden', name='saveFile', value=fileName)
             button.saveButton(type='submit') Сохранить открытый файл
         .deleteFile
           form(action='/delete', method='post')
             input(type='hidden', name='deleteFile', value=fileName)
             button.deleteButton(type='submit') Удалить открытый файл
         .myFiles
           p Список файлов
           ul
            each file in myFilesArr
              li
                a(href="/file/#{file}")=file

       .fileArea
         .topBar
           .fileInfo
             p=fileName
         #editor
           textarea#mdEditor(:value='input', name="fileText", @input='update')=fileText
           .mdView(v-html='compiledMarkdown')
  script.
    new Vue({
    el: '#editor',
    data: {
    input: document.getElementById('mdEditor').value
    },
    computed: {
    compiledMarkdown: function () {
    return marked(this.input, { sanitize: true })
    }
    },
    methods: {
    update: _.debounce(function (e) {
    this.input = e.target.value
    }, 300)
    }
    })
